/*
Copyright (C) 2016  The AlterPCB team
Contact: Maarten Baert <maarten-baert@hotmail.com>

This file is part of AlterPCB.

AlterPCB is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

AlterPCB is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this AlterPCB.  If not, see <http://www.gnu.org/licenses/>.
*/

#include "FemMatrix.h"

#include "Materials.h"
#include "MiscMath.h"

// The following code was generated by the 'fem-matrix-generator.py' Python script in the 'misc' directory.

template<typename F>
inline void FemMatrix_Insert(SparseMatrix<complex_t> &matrix, size_t row, size_t col, F value) {
	if(row != INDEX_NONE && col != INDEX_NONE) {
		matrix.Insert(row, col, value);
	}
}

template<typename F>
inline void FemMatrix_Insert(SparseBlockMatrix<complex_t> &matrix, size_t row, size_t col, F value) {
	if(row != INDEX_NONE && col != INDEX_NONE) {
		matrix.Insert(row, col, value);
	}
}

void FemMatrix_StaticEPot_Rect(SparseBlockMatrix<complex_t> &matrix, size_t vars[8], real_t delta_x, real_t delta_y,
		complex_t permittivity_x, complex_t permittivity_y) {
	FemMatrix_Insert(matrix, vars[0], vars[0], (1.0/3.0)*delta_x*permittivity_y/delta_y + (1.0/3.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[0], vars[1], (1.0/6.0)*delta_x*permittivity_y/delta_y - 1.0/3.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[0], vars[2], -1.0/3.0*delta_x*permittivity_y/delta_y + (1.0/6.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[0], vars[3], -1.0/6.0*delta_x*permittivity_y/delta_y - 1.0/6.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[0], vars[4], (1.0/12.0)*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix, vars[0], vars[5], -1.0/12.0*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix, vars[0], vars[6], (1.0/12.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[0], vars[7], -1.0/12.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[1], vars[0], (1.0/6.0)*delta_x*permittivity_y/delta_y - 1.0/3.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[1], vars[1], (1.0/3.0)*delta_x*permittivity_y/delta_y + (1.0/3.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[1], vars[2], -1.0/6.0*delta_x*permittivity_y/delta_y - 1.0/6.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[1], vars[3], -1.0/3.0*delta_x*permittivity_y/delta_y + (1.0/6.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[1], vars[4], (1.0/12.0)*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix, vars[1], vars[5], -1.0/12.0*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix, vars[1], vars[6], -1.0/12.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[1], vars[7], (1.0/12.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[2], vars[0], -1.0/3.0*delta_x*permittivity_y/delta_y + (1.0/6.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[2], vars[1], -1.0/6.0*delta_x*permittivity_y/delta_y - 1.0/6.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[2], vars[2], (1.0/3.0)*delta_x*permittivity_y/delta_y + (1.0/3.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[2], vars[3], (1.0/6.0)*delta_x*permittivity_y/delta_y - 1.0/3.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[2], vars[4], -1.0/12.0*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix, vars[2], vars[5], (1.0/12.0)*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix, vars[2], vars[6], (1.0/12.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[2], vars[7], -1.0/12.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[3], vars[0], -1.0/6.0*delta_x*permittivity_y/delta_y - 1.0/6.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[3], vars[1], -1.0/3.0*delta_x*permittivity_y/delta_y + (1.0/6.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[3], vars[2], (1.0/6.0)*delta_x*permittivity_y/delta_y - 1.0/3.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[3], vars[3], (1.0/3.0)*delta_x*permittivity_y/delta_y + (1.0/3.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[3], vars[4], -1.0/12.0*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix, vars[3], vars[5], (1.0/12.0)*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix, vars[3], vars[6], -1.0/12.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[3], vars[7], (1.0/12.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[4], vars[0], (1.0/12.0)*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix, vars[4], vars[1], (1.0/12.0)*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix, vars[4], vars[2], -1.0/12.0*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix, vars[4], vars[3], -1.0/12.0*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix, vars[4], vars[4], (1.0/30.0)*delta_x*permittivity_y/delta_y + (1.0/9.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[4], vars[5], -1.0/30.0*delta_x*permittivity_y/delta_y + (1.0/18.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[5], vars[0], -1.0/12.0*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix, vars[5], vars[1], -1.0/12.0*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix, vars[5], vars[2], (1.0/12.0)*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix, vars[5], vars[3], (1.0/12.0)*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix, vars[5], vars[4], -1.0/30.0*delta_x*permittivity_y/delta_y + (1.0/18.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[5], vars[5], (1.0/30.0)*delta_x*permittivity_y/delta_y + (1.0/9.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[6], vars[0], (1.0/12.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[6], vars[1], -1.0/12.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[6], vars[2], (1.0/12.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[6], vars[3], -1.0/12.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[6], vars[6], (1.0/9.0)*delta_x*permittivity_y/delta_y + (1.0/30.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[6], vars[7], (1.0/18.0)*delta_x*permittivity_y/delta_y - 1.0/30.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[7], vars[0], -1.0/12.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[7], vars[1], (1.0/12.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[7], vars[2], -1.0/12.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[7], vars[3], (1.0/12.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[7], vars[6], (1.0/18.0)*delta_x*permittivity_y/delta_y - 1.0/30.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix, vars[7], vars[7], (1.0/9.0)*delta_x*permittivity_y/delta_y + (1.0/30.0)*delta_y*permittivity_x/delta_x);
}

void FemMatrix_StaticMPot_Rect(SparseBlockMatrix<complex_t> &matrix, size_t vars[8], real_t delta_x, real_t delta_y,
		complex_t permeability_x, complex_t permeability_y) {
	FemMatrix_Insert(matrix, vars[0], vars[0], (1.0/3.0)*delta_x/(delta_y*permeability_x) + (1.0/3.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[0], vars[1], (1.0/6.0)*delta_x/(delta_y*permeability_x) - 1.0/3.0*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[0], vars[2], -1.0/3.0*delta_x/(delta_y*permeability_x) + (1.0/6.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[0], vars[3], -1.0/6.0*delta_x/(delta_y*permeability_x) - 1.0/6.0*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[0], vars[4], (1.0/12.0)*delta_x/(delta_y*permeability_x));
	FemMatrix_Insert(matrix, vars[0], vars[5], -1.0/12.0*delta_x/(delta_y*permeability_x));
	FemMatrix_Insert(matrix, vars[0], vars[6], (1.0/12.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[0], vars[7], -1.0/12.0*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[1], vars[0], (1.0/6.0)*delta_x/(delta_y*permeability_x) - 1.0/3.0*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[1], vars[1], (1.0/3.0)*delta_x/(delta_y*permeability_x) + (1.0/3.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[1], vars[2], -1.0/6.0*delta_x/(delta_y*permeability_x) - 1.0/6.0*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[1], vars[3], -1.0/3.0*delta_x/(delta_y*permeability_x) + (1.0/6.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[1], vars[4], (1.0/12.0)*delta_x/(delta_y*permeability_x));
	FemMatrix_Insert(matrix, vars[1], vars[5], -1.0/12.0*delta_x/(delta_y*permeability_x));
	FemMatrix_Insert(matrix, vars[1], vars[6], -1.0/12.0*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[1], vars[7], (1.0/12.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[2], vars[0], -1.0/3.0*delta_x/(delta_y*permeability_x) + (1.0/6.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[2], vars[1], -1.0/6.0*delta_x/(delta_y*permeability_x) - 1.0/6.0*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[2], vars[2], (1.0/3.0)*delta_x/(delta_y*permeability_x) + (1.0/3.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[2], vars[3], (1.0/6.0)*delta_x/(delta_y*permeability_x) - 1.0/3.0*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[2], vars[4], -1.0/12.0*delta_x/(delta_y*permeability_x));
	FemMatrix_Insert(matrix, vars[2], vars[5], (1.0/12.0)*delta_x/(delta_y*permeability_x));
	FemMatrix_Insert(matrix, vars[2], vars[6], (1.0/12.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[2], vars[7], -1.0/12.0*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[3], vars[0], -1.0/6.0*delta_x/(delta_y*permeability_x) - 1.0/6.0*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[3], vars[1], -1.0/3.0*delta_x/(delta_y*permeability_x) + (1.0/6.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[3], vars[2], (1.0/6.0)*delta_x/(delta_y*permeability_x) - 1.0/3.0*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[3], vars[3], (1.0/3.0)*delta_x/(delta_y*permeability_x) + (1.0/3.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[3], vars[4], -1.0/12.0*delta_x/(delta_y*permeability_x));
	FemMatrix_Insert(matrix, vars[3], vars[5], (1.0/12.0)*delta_x/(delta_y*permeability_x));
	FemMatrix_Insert(matrix, vars[3], vars[6], -1.0/12.0*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[3], vars[7], (1.0/12.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[4], vars[0], (1.0/12.0)*delta_x/(delta_y*permeability_x));
	FemMatrix_Insert(matrix, vars[4], vars[1], (1.0/12.0)*delta_x/(delta_y*permeability_x));
	FemMatrix_Insert(matrix, vars[4], vars[2], -1.0/12.0*delta_x/(delta_y*permeability_x));
	FemMatrix_Insert(matrix, vars[4], vars[3], -1.0/12.0*delta_x/(delta_y*permeability_x));
	FemMatrix_Insert(matrix, vars[4], vars[4], (1.0/30.0)*delta_x/(delta_y*permeability_x) + (1.0/9.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[4], vars[5], -1.0/30.0*delta_x/(delta_y*permeability_x) + (1.0/18.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[5], vars[0], -1.0/12.0*delta_x/(delta_y*permeability_x));
	FemMatrix_Insert(matrix, vars[5], vars[1], -1.0/12.0*delta_x/(delta_y*permeability_x));
	FemMatrix_Insert(matrix, vars[5], vars[2], (1.0/12.0)*delta_x/(delta_y*permeability_x));
	FemMatrix_Insert(matrix, vars[5], vars[3], (1.0/12.0)*delta_x/(delta_y*permeability_x));
	FemMatrix_Insert(matrix, vars[5], vars[4], -1.0/30.0*delta_x/(delta_y*permeability_x) + (1.0/18.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[5], vars[5], (1.0/30.0)*delta_x/(delta_y*permeability_x) + (1.0/9.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[6], vars[0], (1.0/12.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[6], vars[1], -1.0/12.0*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[6], vars[2], (1.0/12.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[6], vars[3], -1.0/12.0*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[6], vars[6], (1.0/9.0)*delta_x/(delta_y*permeability_x) + (1.0/30.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[6], vars[7], (1.0/18.0)*delta_x/(delta_y*permeability_x) - 1.0/30.0*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[7], vars[0], -1.0/12.0*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[7], vars[1], (1.0/12.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[7], vars[2], -1.0/12.0*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[7], vars[3], (1.0/12.0)*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[7], vars[6], (1.0/18.0)*delta_x/(delta_y*permeability_x) - 1.0/30.0*delta_y/(delta_x*permeability_y));
	FemMatrix_Insert(matrix, vars[7], vars[7], (1.0/9.0)*delta_x/(delta_y*permeability_x) + (1.0/30.0)*delta_y/(delta_x*permeability_y));
}

void FemMatrix_StaticMPot_XLine(SparseBlockMatrix<complex_t> &matrix, size_t vars[4], real_t delta_x, real_t omega, complex_t impedance) {
	constexpr complex_t I(0.0, 1.0);
	FemMatrix_Insert(matrix, vars[0], vars[0], (1.0/3.0)*I*delta_x*omega/impedance);
	FemMatrix_Insert(matrix, vars[0], vars[1], (1.0/6.0)*I*delta_x*omega/impedance);
	FemMatrix_Insert(matrix, vars[0], vars[2], (1.0/12.0)*I*delta_x*omega/impedance);
	FemMatrix_Insert(matrix, vars[0], vars[3], -1.0/2.0*I*delta_x*omega/impedance);
	FemMatrix_Insert(matrix, vars[1], vars[0], (1.0/6.0)*I*delta_x*omega/impedance);
	FemMatrix_Insert(matrix, vars[1], vars[1], (1.0/3.0)*I*delta_x*omega/impedance);
	FemMatrix_Insert(matrix, vars[1], vars[2], (1.0/12.0)*I*delta_x*omega/impedance);
	FemMatrix_Insert(matrix, vars[1], vars[3], -1.0/2.0*I*delta_x*omega/impedance);
	FemMatrix_Insert(matrix, vars[2], vars[0], (1.0/12.0)*I*delta_x*omega/impedance);
	FemMatrix_Insert(matrix, vars[2], vars[1], (1.0/12.0)*I*delta_x*omega/impedance);
	FemMatrix_Insert(matrix, vars[2], vars[2], (1.0/30.0)*I*delta_x*omega/impedance);
	FemMatrix_Insert(matrix, vars[2], vars[3], -1.0/6.0*I*delta_x*omega/impedance);
	FemMatrix_Insert(matrix, vars[3], vars[0], -1.0/2.0*I*delta_x*omega/impedance);
	FemMatrix_Insert(matrix, vars[3], vars[1], -1.0/2.0*I*delta_x*omega/impedance);
	FemMatrix_Insert(matrix, vars[3], vars[2], -1.0/6.0*I*delta_x*omega/impedance);
	FemMatrix_Insert(matrix, vars[3], vars[3], I*delta_x*omega/impedance);
}

void FemMatrix_StaticMPot_YLine(SparseBlockMatrix<complex_t> &matrix, size_t vars[4], real_t delta_y, real_t omega, complex_t impedance) {
	constexpr complex_t I(0.0, 1.0);
	FemMatrix_Insert(matrix, vars[0], vars[0], (1.0/3.0)*I*delta_y*omega/impedance);
	FemMatrix_Insert(matrix, vars[0], vars[1], (1.0/6.0)*I*delta_y*omega/impedance);
	FemMatrix_Insert(matrix, vars[0], vars[2], (1.0/12.0)*I*delta_y*omega/impedance);
	FemMatrix_Insert(matrix, vars[0], vars[3], -1.0/2.0*I*delta_y*omega/impedance);
	FemMatrix_Insert(matrix, vars[1], vars[0], (1.0/6.0)*I*delta_y*omega/impedance);
	FemMatrix_Insert(matrix, vars[1], vars[1], (1.0/3.0)*I*delta_y*omega/impedance);
	FemMatrix_Insert(matrix, vars[1], vars[2], (1.0/12.0)*I*delta_y*omega/impedance);
	FemMatrix_Insert(matrix, vars[1], vars[3], -1.0/2.0*I*delta_y*omega/impedance);
	FemMatrix_Insert(matrix, vars[2], vars[0], (1.0/12.0)*I*delta_y*omega/impedance);
	FemMatrix_Insert(matrix, vars[2], vars[1], (1.0/12.0)*I*delta_y*omega/impedance);
	FemMatrix_Insert(matrix, vars[2], vars[2], (1.0/30.0)*I*delta_y*omega/impedance);
	FemMatrix_Insert(matrix, vars[2], vars[3], -1.0/6.0*I*delta_y*omega/impedance);
	FemMatrix_Insert(matrix, vars[3], vars[0], -1.0/2.0*I*delta_y*omega/impedance);
	FemMatrix_Insert(matrix, vars[3], vars[1], -1.0/2.0*I*delta_y*omega/impedance);
	FemMatrix_Insert(matrix, vars[3], vars[2], -1.0/6.0*I*delta_y*omega/impedance);
	FemMatrix_Insert(matrix, vars[3], vars[3], I*delta_y*omega/impedance);
}

void FemMatrix_FullEMPot_Rect(SparseMatrix<complex_t> matrix[2], size_t vars[24], real_t delta_x, real_t delta_y, real_t omega,
		complex_t permittivity_x, complex_t permittivity_y, complex_t permittivity_z,
		complex_t permeability_x, complex_t permeability_y, complex_t permeability_z) {
	constexpr complex_t I(0.0, 1.0);
	FemMatrix_Insert(matrix[0], vars[0], vars[0], (1.0/3.0)*delta_x*permittivity_y/delta_y + (1.0/3.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[0], vars[1], (1.0/6.0)*delta_x*permittivity_y/delta_y - 1.0/3.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[0], vars[2], -1.0/3.0*delta_x*permittivity_y/delta_y + (1.0/6.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[0], vars[3], -1.0/6.0*delta_x*permittivity_y/delta_y - 1.0/6.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[0], vars[4], (1.0/12.0)*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix[0], vars[0], vars[5], -1.0/12.0*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix[0], vars[0], vars[6], (1.0/12.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[0], vars[7], -1.0/12.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[0], vars[8], -1.0/3.0*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[0], vars[9], -1.0/6.0*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[0], vars[12], -1.0/3.0*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[0], vars[13], -1.0/6.0*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[1], vars[0], (1.0/6.0)*delta_x*permittivity_y/delta_y - 1.0/3.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[1], vars[1], (1.0/3.0)*delta_x*permittivity_y/delta_y + (1.0/3.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[1], vars[2], -1.0/6.0*delta_x*permittivity_y/delta_y - 1.0/6.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[1], vars[3], -1.0/3.0*delta_x*permittivity_y/delta_y + (1.0/6.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[1], vars[4], (1.0/12.0)*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix[0], vars[1], vars[5], -1.0/12.0*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix[0], vars[1], vars[6], -1.0/12.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[1], vars[7], (1.0/12.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[1], vars[8], (1.0/3.0)*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[1], vars[9], (1.0/6.0)*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[1], vars[12], -1.0/6.0*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[1], vars[13], -1.0/3.0*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[2], vars[0], -1.0/3.0*delta_x*permittivity_y/delta_y + (1.0/6.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[2], vars[1], -1.0/6.0*delta_x*permittivity_y/delta_y - 1.0/6.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[2], vars[2], (1.0/3.0)*delta_x*permittivity_y/delta_y + (1.0/3.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[2], vars[3], (1.0/6.0)*delta_x*permittivity_y/delta_y - 1.0/3.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[2], vars[4], -1.0/12.0*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix[0], vars[2], vars[5], (1.0/12.0)*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix[0], vars[2], vars[6], (1.0/12.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[2], vars[7], -1.0/12.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[2], vars[8], -1.0/6.0*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[2], vars[9], -1.0/3.0*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[2], vars[12], (1.0/3.0)*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[2], vars[13], (1.0/6.0)*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[3], vars[0], -1.0/6.0*delta_x*permittivity_y/delta_y - 1.0/6.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[3], vars[1], -1.0/3.0*delta_x*permittivity_y/delta_y + (1.0/6.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[3], vars[2], (1.0/6.0)*delta_x*permittivity_y/delta_y - 1.0/3.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[3], vars[3], (1.0/3.0)*delta_x*permittivity_y/delta_y + (1.0/3.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[3], vars[4], -1.0/12.0*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix[0], vars[3], vars[5], (1.0/12.0)*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix[0], vars[3], vars[6], -1.0/12.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[3], vars[7], (1.0/12.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[3], vars[8], (1.0/6.0)*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[3], vars[9], (1.0/3.0)*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[3], vars[12], (1.0/6.0)*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[3], vars[13], (1.0/3.0)*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[4], vars[0], (1.0/12.0)*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix[0], vars[4], vars[1], (1.0/12.0)*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix[0], vars[4], vars[2], -1.0/12.0*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix[0], vars[4], vars[3], -1.0/12.0*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix[0], vars[4], vars[4], (1.0/30.0)*delta_x*permittivity_y/delta_y + (1.0/9.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[4], vars[5], -1.0/30.0*delta_x*permittivity_y/delta_y + (1.0/18.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[4], vars[10], -1.0/18.0*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[4], vars[11], -1.0/36.0*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[4], vars[12], -1.0/12.0*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[4], vars[13], -1.0/12.0*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[5], vars[0], -1.0/12.0*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix[0], vars[5], vars[1], -1.0/12.0*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix[0], vars[5], vars[2], (1.0/12.0)*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix[0], vars[5], vars[3], (1.0/12.0)*delta_x*permittivity_y/delta_y);
	FemMatrix_Insert(matrix[0], vars[5], vars[4], -1.0/30.0*delta_x*permittivity_y/delta_y + (1.0/18.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[5], vars[5], (1.0/30.0)*delta_x*permittivity_y/delta_y + (1.0/9.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[5], vars[10], -1.0/36.0*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[5], vars[11], -1.0/18.0*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[5], vars[12], (1.0/12.0)*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[5], vars[13], (1.0/12.0)*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[6], vars[0], (1.0/12.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[6], vars[1], -1.0/12.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[6], vars[2], (1.0/12.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[6], vars[3], -1.0/12.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[6], vars[6], (1.0/9.0)*delta_x*permittivity_y/delta_y + (1.0/30.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[6], vars[7], (1.0/18.0)*delta_x*permittivity_y/delta_y - 1.0/30.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[6], vars[8], -1.0/12.0*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[6], vars[9], -1.0/12.0*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[6], vars[14], -1.0/18.0*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[6], vars[15], -1.0/36.0*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[7], vars[0], -1.0/12.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[7], vars[1], (1.0/12.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[7], vars[2], -1.0/12.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[7], vars[3], (1.0/12.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[7], vars[6], (1.0/18.0)*delta_x*permittivity_y/delta_y - 1.0/30.0*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[7], vars[7], (1.0/9.0)*delta_x*permittivity_y/delta_y + (1.0/30.0)*delta_y*permittivity_x/delta_x);
	FemMatrix_Insert(matrix[0], vars[7], vars[8], (1.0/12.0)*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[7], vars[9], (1.0/12.0)*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[7], vars[14], -1.0/36.0*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[7], vars[15], -1.0/18.0*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[8], vars[0], -1.0/3.0*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[8], vars[1], (1.0/3.0)*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[8], vars[2], -1.0/6.0*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[8], vars[3], (1.0/6.0)*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[8], vars[6], -1.0/12.0*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[8], vars[7], (1.0/12.0)*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[8], vars[8], -1.0/3.0*delta_x*delta_y*square(omega)*permittivity_x/square(SPEED_OF_LIGHT) + delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_z));
	FemMatrix_Insert(matrix[0], vars[8], vars[9], -1.0/6.0*delta_x*delta_y*square(omega)*permittivity_x/square(SPEED_OF_LIGHT) - delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_z));
	FemMatrix_Insert(matrix[0], vars[8], vars[12], -1.0/(square(SPEED_OF_LIGHT)*permeability_z));
	FemMatrix_Insert(matrix[0], vars[8], vars[13], 1.0/(square(SPEED_OF_LIGHT)*permeability_z));
	FemMatrix_Insert(matrix[0], vars[9], vars[0], -1.0/6.0*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[9], vars[1], (1.0/6.0)*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[9], vars[2], -1.0/3.0*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[9], vars[3], (1.0/3.0)*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[9], vars[6], -1.0/12.0*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[9], vars[7], (1.0/12.0)*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[9], vars[8], -1.0/6.0*delta_x*delta_y*square(omega)*permittivity_x/square(SPEED_OF_LIGHT) - delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_z));
	FemMatrix_Insert(matrix[0], vars[9], vars[9], -1.0/3.0*delta_x*delta_y*square(omega)*permittivity_x/square(SPEED_OF_LIGHT) + delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_z));
	FemMatrix_Insert(matrix[0], vars[9], vars[12], 1.0/(square(SPEED_OF_LIGHT)*permeability_z));
	FemMatrix_Insert(matrix[0], vars[9], vars[13], -1.0/(square(SPEED_OF_LIGHT)*permeability_z));
	FemMatrix_Insert(matrix[0], vars[10], vars[4], -1.0/18.0*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[10], vars[5], -1.0/36.0*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[10], vars[10], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_x/square(SPEED_OF_LIGHT) + (1.0/12.0)*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_z));
	FemMatrix_Insert(matrix[0], vars[10], vars[11], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_x/square(SPEED_OF_LIGHT) - 1.0/12.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_z));
	FemMatrix_Insert(matrix[0], vars[11], vars[4], -1.0/36.0*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[11], vars[5], -1.0/18.0*I*delta_y*omega*permittivity_x/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[11], vars[10], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_x/square(SPEED_OF_LIGHT) - 1.0/12.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_z));
	FemMatrix_Insert(matrix[0], vars[11], vars[11], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_x/square(SPEED_OF_LIGHT) + (1.0/12.0)*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_z));
	FemMatrix_Insert(matrix[0], vars[12], vars[0], -1.0/3.0*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[12], vars[1], -1.0/6.0*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[12], vars[2], (1.0/3.0)*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[12], vars[3], (1.0/6.0)*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[12], vars[4], -1.0/12.0*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[12], vars[5], (1.0/12.0)*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[12], vars[8], -1.0/(square(SPEED_OF_LIGHT)*permeability_z));
	FemMatrix_Insert(matrix[0], vars[12], vars[9], 1.0/(square(SPEED_OF_LIGHT)*permeability_z));
	FemMatrix_Insert(matrix[0], vars[12], vars[12], -1.0/3.0*delta_x*delta_y*square(omega)*permittivity_y/square(SPEED_OF_LIGHT) + delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_z));
	FemMatrix_Insert(matrix[0], vars[12], vars[13], -1.0/6.0*delta_x*delta_y*square(omega)*permittivity_y/square(SPEED_OF_LIGHT) - delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_z));
	FemMatrix_Insert(matrix[0], vars[13], vars[0], -1.0/6.0*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[13], vars[1], -1.0/3.0*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[13], vars[2], (1.0/6.0)*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[13], vars[3], (1.0/3.0)*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[13], vars[4], -1.0/12.0*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[13], vars[5], (1.0/12.0)*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[13], vars[8], 1.0/(square(SPEED_OF_LIGHT)*permeability_z));
	FemMatrix_Insert(matrix[0], vars[13], vars[9], -1.0/(square(SPEED_OF_LIGHT)*permeability_z));
	FemMatrix_Insert(matrix[0], vars[13], vars[12], -1.0/6.0*delta_x*delta_y*square(omega)*permittivity_y/square(SPEED_OF_LIGHT) - delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_z));
	FemMatrix_Insert(matrix[0], vars[13], vars[13], -1.0/3.0*delta_x*delta_y*square(omega)*permittivity_y/square(SPEED_OF_LIGHT) + delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_z));
	FemMatrix_Insert(matrix[0], vars[14], vars[6], -1.0/18.0*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[14], vars[7], -1.0/36.0*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[14], vars[14], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_y/square(SPEED_OF_LIGHT) + (1.0/12.0)*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_z));
	FemMatrix_Insert(matrix[0], vars[14], vars[15], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_y/square(SPEED_OF_LIGHT) - 1.0/12.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_z));
	FemMatrix_Insert(matrix[0], vars[15], vars[6], -1.0/36.0*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[15], vars[7], -1.0/18.0*I*delta_x*omega*permittivity_y/SPEED_OF_LIGHT);
	FemMatrix_Insert(matrix[0], vars[15], vars[14], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_y/square(SPEED_OF_LIGHT) - 1.0/12.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_z));
	FemMatrix_Insert(matrix[0], vars[15], vars[15], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_y/square(SPEED_OF_LIGHT) + (1.0/12.0)*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_z));
	FemMatrix_Insert(matrix[1], vars[0], vars[0], (1.0/9.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[0], vars[1], (1.0/18.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[0], vars[2], (1.0/18.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[0], vars[3], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[0], vars[4], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[0], vars[5], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[0], vars[6], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[0], vars[7], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[0], vars[16], -1.0/9.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[0], vars[17], -1.0/18.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[0], vars[18], -1.0/18.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[0], vars[19], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[0], vars[20], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[0], vars[21], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[0], vars[22], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[0], vars[23], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[1], vars[0], (1.0/18.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[1], vars[1], (1.0/9.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[1], vars[2], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[1], vars[3], (1.0/18.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[1], vars[4], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[1], vars[5], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[1], vars[6], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[1], vars[7], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[1], vars[16], -1.0/18.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[1], vars[17], -1.0/9.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[1], vars[18], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[1], vars[19], -1.0/18.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[1], vars[20], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[1], vars[21], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[1], vars[22], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[1], vars[23], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[2], vars[0], (1.0/18.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[2], vars[1], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[2], vars[2], (1.0/9.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[2], vars[3], (1.0/18.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[2], vars[4], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[2], vars[5], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[2], vars[6], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[2], vars[7], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[2], vars[16], -1.0/18.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[2], vars[17], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[2], vars[18], -1.0/9.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[2], vars[19], -1.0/18.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[2], vars[20], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[2], vars[21], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[2], vars[22], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[2], vars[23], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[3], vars[0], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[3], vars[1], (1.0/18.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[3], vars[2], (1.0/18.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[3], vars[3], (1.0/9.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[3], vars[4], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[3], vars[5], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[3], vars[6], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[3], vars[7], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[3], vars[16], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[3], vars[17], -1.0/18.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[3], vars[18], -1.0/18.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[3], vars[19], -1.0/9.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[3], vars[20], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[3], vars[21], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[3], vars[22], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[3], vars[23], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[4], vars[0], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[4], vars[1], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[4], vars[2], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[4], vars[3], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[4], vars[4], (1.0/90.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[4], vars[5], (1.0/180.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[4], vars[6], (1.0/144.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[4], vars[7], (1.0/144.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[4], vars[16], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[4], vars[17], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[4], vars[18], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[4], vars[19], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[4], vars[20], -1.0/90.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[4], vars[21], -1.0/180.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[4], vars[22], -1.0/144.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[4], vars[23], -1.0/144.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[5], vars[0], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[5], vars[1], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[5], vars[2], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[5], vars[3], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[5], vars[4], (1.0/180.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[5], vars[5], (1.0/90.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[5], vars[6], (1.0/144.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[5], vars[7], (1.0/144.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[5], vars[16], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[5], vars[17], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[5], vars[18], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[5], vars[19], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[5], vars[20], -1.0/180.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[5], vars[21], -1.0/90.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[5], vars[22], -1.0/144.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[5], vars[23], -1.0/144.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[6], vars[0], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[6], vars[1], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[6], vars[2], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[6], vars[3], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[6], vars[4], (1.0/144.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[6], vars[5], (1.0/144.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[6], vars[6], (1.0/90.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[6], vars[7], (1.0/180.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[6], vars[16], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[6], vars[17], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[6], vars[18], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[6], vars[19], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[6], vars[20], -1.0/144.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[6], vars[21], -1.0/144.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[6], vars[22], -1.0/90.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[6], vars[23], -1.0/180.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[7], vars[0], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[7], vars[1], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[7], vars[2], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[7], vars[3], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[7], vars[4], (1.0/144.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[7], vars[5], (1.0/144.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[7], vars[6], (1.0/180.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[7], vars[7], (1.0/90.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[7], vars[16], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[7], vars[17], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[7], vars[18], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[7], vars[19], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[7], vars[20], -1.0/144.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[7], vars[21], -1.0/144.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[7], vars[22], -1.0/180.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[7], vars[23], -1.0/90.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[8], vars[8], (1.0/3.0)*delta_x*delta_y*square(omega)/(std::pow(SPEED_OF_LIGHT, 4)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[8], vars[9], (1.0/6.0)*delta_x*delta_y*square(omega)/(std::pow(SPEED_OF_LIGHT, 4)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[8], vars[16], (1.0/3.0)*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[8], vars[17], -1.0/3.0*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[8], vars[18], (1.0/6.0)*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[8], vars[19], -1.0/6.0*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[8], vars[22], (1.0/12.0)*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[8], vars[23], -1.0/12.0*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[9], vars[8], (1.0/6.0)*delta_x*delta_y*square(omega)/(std::pow(SPEED_OF_LIGHT, 4)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[9], vars[9], (1.0/3.0)*delta_x*delta_y*square(omega)/(std::pow(SPEED_OF_LIGHT, 4)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[9], vars[16], (1.0/6.0)*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[9], vars[17], -1.0/6.0*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[9], vars[18], (1.0/3.0)*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[9], vars[19], -1.0/3.0*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[9], vars[22], (1.0/12.0)*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[9], vars[23], -1.0/12.0*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[10], vars[10], (1.0/36.0)*delta_x*delta_y*square(omega)/(std::pow(SPEED_OF_LIGHT, 4)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[10], vars[11], (1.0/72.0)*delta_x*delta_y*square(omega)/(std::pow(SPEED_OF_LIGHT, 4)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[10], vars[20], (1.0/18.0)*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[10], vars[21], (1.0/36.0)*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[11], vars[10], (1.0/72.0)*delta_x*delta_y*square(omega)/(std::pow(SPEED_OF_LIGHT, 4)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[11], vars[11], (1.0/36.0)*delta_x*delta_y*square(omega)/(std::pow(SPEED_OF_LIGHT, 4)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[11], vars[20], (1.0/36.0)*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[11], vars[21], (1.0/18.0)*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[12], vars[12], (1.0/3.0)*delta_x*delta_y*square(omega)/(std::pow(SPEED_OF_LIGHT, 4)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[12], vars[13], (1.0/6.0)*delta_x*delta_y*square(omega)/(std::pow(SPEED_OF_LIGHT, 4)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[12], vars[16], (1.0/3.0)*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[12], vars[17], (1.0/6.0)*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[12], vars[18], -1.0/3.0*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[12], vars[19], -1.0/6.0*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[12], vars[20], (1.0/12.0)*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[12], vars[21], -1.0/12.0*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[13], vars[12], (1.0/6.0)*delta_x*delta_y*square(omega)/(std::pow(SPEED_OF_LIGHT, 4)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[13], vars[13], (1.0/3.0)*delta_x*delta_y*square(omega)/(std::pow(SPEED_OF_LIGHT, 4)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[13], vars[16], (1.0/6.0)*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[13], vars[17], (1.0/3.0)*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[13], vars[18], -1.0/6.0*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[13], vars[19], -1.0/3.0*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[13], vars[20], (1.0/12.0)*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[13], vars[21], -1.0/12.0*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[14], vars[14], (1.0/36.0)*delta_x*delta_y*square(omega)/(std::pow(SPEED_OF_LIGHT, 4)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[14], vars[15], (1.0/72.0)*delta_x*delta_y*square(omega)/(std::pow(SPEED_OF_LIGHT, 4)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[14], vars[22], (1.0/18.0)*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[14], vars[23], (1.0/36.0)*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[15], vars[14], (1.0/72.0)*delta_x*delta_y*square(omega)/(std::pow(SPEED_OF_LIGHT, 4)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[15], vars[15], (1.0/36.0)*delta_x*delta_y*square(omega)/(std::pow(SPEED_OF_LIGHT, 4)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[15], vars[22], (1.0/36.0)*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[15], vars[23], (1.0/18.0)*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[16], vars[0], -1.0/9.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[16], vars[1], -1.0/18.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[16], vars[2], -1.0/18.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[16], vars[3], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[16], vars[4], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[16], vars[5], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[16], vars[6], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[16], vars[7], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[16], vars[8], (1.0/3.0)*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[16], vars[9], (1.0/6.0)*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[16], vars[12], (1.0/3.0)*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[16], vars[13], (1.0/6.0)*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[16], vars[16], (1.0/9.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/3.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) - 1.0/3.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[16], vars[17], (1.0/18.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/6.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) + (1.0/3.0)*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[16], vars[18], (1.0/18.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/3.0)*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) - 1.0/6.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[16], vars[19], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/6.0)*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) + (1.0/6.0)*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[16], vars[20], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/12.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x));
	FemMatrix_Insert(matrix[1], vars[16], vars[21], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/12.0)*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x));
	FemMatrix_Insert(matrix[1], vars[16], vars[22], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/12.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[16], vars[23], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/12.0)*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[17], vars[0], -1.0/18.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[17], vars[1], -1.0/9.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[17], vars[2], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[17], vars[3], -1.0/18.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[17], vars[4], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[17], vars[5], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[17], vars[6], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[17], vars[7], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[17], vars[8], -1.0/3.0*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[17], vars[9], -1.0/6.0*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[17], vars[12], (1.0/6.0)*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[17], vars[13], (1.0/3.0)*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[17], vars[16], (1.0/18.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/6.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) + (1.0/3.0)*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[17], vars[17], (1.0/9.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/3.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) - 1.0/3.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[17], vars[18], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/6.0)*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) + (1.0/6.0)*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[17], vars[19], (1.0/18.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/3.0)*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) - 1.0/6.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[17], vars[20], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/12.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x));
	FemMatrix_Insert(matrix[1], vars[17], vars[21], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/12.0)*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x));
	FemMatrix_Insert(matrix[1], vars[17], vars[22], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/12.0)*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[17], vars[23], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/12.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[18], vars[0], -1.0/18.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[18], vars[1], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[18], vars[2], -1.0/9.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[18], vars[3], -1.0/18.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[18], vars[4], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[18], vars[5], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[18], vars[6], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[18], vars[7], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[18], vars[8], (1.0/6.0)*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[18], vars[9], (1.0/3.0)*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[18], vars[12], -1.0/3.0*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[18], vars[13], -1.0/6.0*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[18], vars[16], (1.0/18.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/3.0)*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) - 1.0/6.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[18], vars[17], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/6.0)*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) + (1.0/6.0)*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[18], vars[18], (1.0/9.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/3.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) - 1.0/3.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[18], vars[19], (1.0/18.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/6.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) + (1.0/3.0)*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[18], vars[20], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/12.0)*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x));
	FemMatrix_Insert(matrix[1], vars[18], vars[21], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/12.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x));
	FemMatrix_Insert(matrix[1], vars[18], vars[22], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/12.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[18], vars[23], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/12.0)*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[19], vars[0], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[19], vars[1], -1.0/18.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[19], vars[2], -1.0/18.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[19], vars[3], -1.0/9.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[19], vars[4], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[19], vars[5], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[19], vars[6], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[19], vars[7], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[19], vars[8], -1.0/6.0*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[19], vars[9], -1.0/3.0*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[19], vars[12], -1.0/6.0*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[19], vars[13], -1.0/3.0*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[19], vars[16], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/6.0)*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) + (1.0/6.0)*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[19], vars[17], (1.0/18.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/3.0)*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) - 1.0/6.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[19], vars[18], (1.0/18.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/6.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) + (1.0/3.0)*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[19], vars[19], (1.0/9.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/3.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) - 1.0/3.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[19], vars[20], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/12.0)*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x));
	FemMatrix_Insert(matrix[1], vars[19], vars[21], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/12.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x));
	FemMatrix_Insert(matrix[1], vars[19], vars[22], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/12.0)*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[19], vars[23], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/12.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[20], vars[0], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[20], vars[1], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[20], vars[2], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[20], vars[3], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[20], vars[4], -1.0/90.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[20], vars[5], -1.0/180.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[20], vars[6], -1.0/144.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[20], vars[7], -1.0/144.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[20], vars[10], (1.0/18.0)*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[20], vars[11], (1.0/36.0)*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[20], vars[12], (1.0/12.0)*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[20], vars[13], (1.0/12.0)*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[20], vars[16], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/12.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x));
	FemMatrix_Insert(matrix[1], vars[20], vars[17], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/12.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x));
	FemMatrix_Insert(matrix[1], vars[20], vars[18], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/12.0)*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x));
	FemMatrix_Insert(matrix[1], vars[20], vars[19], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/12.0)*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x));
	FemMatrix_Insert(matrix[1], vars[20], vars[20], (1.0/90.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/30.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) - 1.0/9.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[20], vars[21], (1.0/180.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/30.0)*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) - 1.0/18.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[20], vars[22], (1.0/144.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[20], vars[23], (1.0/144.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[21], vars[0], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[21], vars[1], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[21], vars[2], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[21], vars[3], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[21], vars[4], -1.0/180.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[21], vars[5], -1.0/90.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[21], vars[6], -1.0/144.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[21], vars[7], -1.0/144.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[21], vars[10], (1.0/36.0)*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[21], vars[11], (1.0/18.0)*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[21], vars[12], -1.0/12.0*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[21], vars[13], -1.0/12.0*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[21], vars[16], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/12.0)*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x));
	FemMatrix_Insert(matrix[1], vars[21], vars[17], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/12.0)*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x));
	FemMatrix_Insert(matrix[1], vars[21], vars[18], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/12.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x));
	FemMatrix_Insert(matrix[1], vars[21], vars[19], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/12.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x));
	FemMatrix_Insert(matrix[1], vars[21], vars[20], (1.0/180.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/30.0)*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) - 1.0/18.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[21], vars[21], (1.0/90.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/30.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) - 1.0/9.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[21], vars[22], (1.0/144.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[21], vars[23], (1.0/144.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[22], vars[0], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[22], vars[1], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[22], vars[2], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[22], vars[3], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[22], vars[4], -1.0/144.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[22], vars[5], -1.0/144.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[22], vars[6], -1.0/90.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[22], vars[7], -1.0/180.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[22], vars[8], (1.0/12.0)*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[22], vars[9], (1.0/12.0)*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[22], vars[14], (1.0/18.0)*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[22], vars[15], (1.0/36.0)*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[22], vars[16], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/12.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[22], vars[17], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/12.0)*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[22], vars[18], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/12.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[22], vars[19], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/12.0)*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[22], vars[20], (1.0/144.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[22], vars[21], (1.0/144.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[22], vars[22], (1.0/90.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/9.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) - 1.0/30.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[22], vars[23], (1.0/180.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/18.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) + (1.0/30.0)*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[23], vars[0], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[23], vars[1], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[23], vars[2], -1.0/72.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[23], vars[3], -1.0/36.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[23], vars[4], -1.0/144.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[23], vars[5], -1.0/144.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[23], vars[6], -1.0/180.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[23], vars[7], -1.0/90.0*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[23], vars[8], -1.0/12.0*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[23], vars[9], -1.0/12.0*I*delta_y*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_y));
	FemMatrix_Insert(matrix[1], vars[23], vars[14], (1.0/36.0)*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[23], vars[15], (1.0/18.0)*I*delta_x*omega/(std::pow(SPEED_OF_LIGHT, 3)*permeability_x));
	FemMatrix_Insert(matrix[1], vars[23], vars[16], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/12.0)*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[23], vars[17], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/12.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[23], vars[18], (1.0/72.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) + (1.0/12.0)*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[23], vars[19], (1.0/36.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/12.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[23], vars[20], (1.0/144.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[23], vars[21], (1.0/144.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT));
	FemMatrix_Insert(matrix[1], vars[23], vars[22], (1.0/180.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/18.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) + (1.0/30.0)*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
	FemMatrix_Insert(matrix[1], vars[23], vars[23], (1.0/90.0)*delta_x*delta_y*square(omega)*permittivity_z/square(SPEED_OF_LIGHT) - 1.0/9.0*delta_x/(square(SPEED_OF_LIGHT)*delta_y*permeability_x) - 1.0/30.0*delta_y/(square(SPEED_OF_LIGHT)*delta_x*permeability_y));
}

void FemMatrix_FullEMPot_XLine(SparseMatrix<complex_t> matrix[2], size_t vars[8], real_t delta_x, real_t omega, complex_t impedance) {
	constexpr complex_t I(0.0, 1.0);
	FemMatrix_Insert(matrix[0], vars[0], vars[0], -I/(delta_x*impedance*omega));
	FemMatrix_Insert(matrix[0], vars[0], vars[1], I/(delta_x*impedance*omega));
	FemMatrix_Insert(matrix[0], vars[0], vars[3], -1.0/(SPEED_OF_LIGHT*impedance));
	FemMatrix_Insert(matrix[0], vars[1], vars[0], I/(delta_x*impedance*omega));
	FemMatrix_Insert(matrix[0], vars[1], vars[1], -I/(delta_x*impedance*omega));
	FemMatrix_Insert(matrix[0], vars[1], vars[3], 1.0/(SPEED_OF_LIGHT*impedance));
	FemMatrix_Insert(matrix[0], vars[2], vars[2], -1.0/3.0*I/(delta_x*impedance*omega));
	FemMatrix_Insert(matrix[0], vars[2], vars[4], -1.0/6.0/(SPEED_OF_LIGHT*impedance));
	FemMatrix_Insert(matrix[0], vars[3], vars[0], -1.0/(SPEED_OF_LIGHT*impedance));
	FemMatrix_Insert(matrix[0], vars[3], vars[1], 1.0/(SPEED_OF_LIGHT*impedance));
	FemMatrix_Insert(matrix[0], vars[3], vars[3], I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[0], vars[4], vars[2], -1.0/6.0/(SPEED_OF_LIGHT*impedance));
	FemMatrix_Insert(matrix[0], vars[4], vars[4], (1.0/12.0)*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[0], vars[0], -1.0/3.0*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[0], vars[1], -1.0/6.0*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[0], vars[2], -1.0/12.0*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[0], vars[5], (1.0/3.0)*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[0], vars[6], (1.0/6.0)*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[0], vars[7], (1.0/12.0)*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[1], vars[0], -1.0/6.0*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[1], vars[1], -1.0/3.0*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[1], vars[2], -1.0/12.0*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[1], vars[5], (1.0/6.0)*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[1], vars[6], (1.0/3.0)*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[1], vars[7], (1.0/12.0)*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[2], vars[0], -1.0/12.0*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[2], vars[1], -1.0/12.0*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[2], vars[2], -1.0/30.0*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[2], vars[5], (1.0/12.0)*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[2], vars[6], (1.0/12.0)*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[2], vars[7], (1.0/30.0)*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[5], vars[0], (1.0/3.0)*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[5], vars[1], (1.0/6.0)*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[5], vars[2], (1.0/12.0)*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[5], vars[5], -1.0/3.0*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[5], vars[6], -1.0/6.0*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[5], vars[7], -1.0/12.0*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[6], vars[0], (1.0/6.0)*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[6], vars[1], (1.0/3.0)*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[6], vars[2], (1.0/12.0)*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[6], vars[5], -1.0/6.0*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[6], vars[6], -1.0/3.0*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[6], vars[7], -1.0/12.0*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[7], vars[0], (1.0/12.0)*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[7], vars[1], (1.0/12.0)*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[7], vars[2], (1.0/30.0)*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[7], vars[5], -1.0/12.0*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[7], vars[6], -1.0/12.0*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[7], vars[7], -1.0/30.0*I*delta_x*omega/(square(SPEED_OF_LIGHT)*impedance));
}

void FemMatrix_FullEMPot_YLine(SparseMatrix<complex_t> matrix[2], size_t vars[8], real_t delta_y, real_t omega, complex_t impedance) {
	constexpr complex_t I(0.0, 1.0);
	FemMatrix_Insert(matrix[0], vars[0], vars[0], -I/(delta_y*impedance*omega));
	FemMatrix_Insert(matrix[0], vars[0], vars[1], I/(delta_y*impedance*omega));
	FemMatrix_Insert(matrix[0], vars[0], vars[3], -1.0/(SPEED_OF_LIGHT*impedance));
	FemMatrix_Insert(matrix[0], vars[1], vars[0], I/(delta_y*impedance*omega));
	FemMatrix_Insert(matrix[0], vars[1], vars[1], -I/(delta_y*impedance*omega));
	FemMatrix_Insert(matrix[0], vars[1], vars[3], 1.0/(SPEED_OF_LIGHT*impedance));
	FemMatrix_Insert(matrix[0], vars[2], vars[2], -1.0/3.0*I/(delta_y*impedance*omega));
	FemMatrix_Insert(matrix[0], vars[2], vars[4], -1.0/6.0/(SPEED_OF_LIGHT*impedance));
	FemMatrix_Insert(matrix[0], vars[3], vars[0], -1.0/(SPEED_OF_LIGHT*impedance));
	FemMatrix_Insert(matrix[0], vars[3], vars[1], 1.0/(SPEED_OF_LIGHT*impedance));
	FemMatrix_Insert(matrix[0], vars[3], vars[3], I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[0], vars[4], vars[2], -1.0/6.0/(SPEED_OF_LIGHT*impedance));
	FemMatrix_Insert(matrix[0], vars[4], vars[4], (1.0/12.0)*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[0], vars[0], -1.0/3.0*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[0], vars[1], -1.0/6.0*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[0], vars[2], -1.0/12.0*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[0], vars[5], (1.0/3.0)*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[0], vars[6], (1.0/6.0)*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[0], vars[7], (1.0/12.0)*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[1], vars[0], -1.0/6.0*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[1], vars[1], -1.0/3.0*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[1], vars[2], -1.0/12.0*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[1], vars[5], (1.0/6.0)*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[1], vars[6], (1.0/3.0)*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[1], vars[7], (1.0/12.0)*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[2], vars[0], -1.0/12.0*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[2], vars[1], -1.0/12.0*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[2], vars[2], -1.0/30.0*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[2], vars[5], (1.0/12.0)*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[2], vars[6], (1.0/12.0)*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[2], vars[7], (1.0/30.0)*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[5], vars[0], (1.0/3.0)*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[5], vars[1], (1.0/6.0)*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[5], vars[2], (1.0/12.0)*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[5], vars[5], -1.0/3.0*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[5], vars[6], -1.0/6.0*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[5], vars[7], -1.0/12.0*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[6], vars[0], (1.0/6.0)*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[6], vars[1], (1.0/3.0)*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[6], vars[2], (1.0/12.0)*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[6], vars[5], -1.0/6.0*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[6], vars[6], -1.0/3.0*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[6], vars[7], -1.0/12.0*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[7], vars[0], (1.0/12.0)*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[7], vars[1], (1.0/12.0)*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[7], vars[2], (1.0/30.0)*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[7], vars[5], -1.0/12.0*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[7], vars[6], -1.0/12.0*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
	FemMatrix_Insert(matrix[1], vars[7], vars[7], -1.0/30.0*I*delta_y*omega/(square(SPEED_OF_LIGHT)*impedance));
}
